var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire08a5;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var n=$parcel$inits[e];delete $parcel$inits[e];var o={id:e,exports:{}};return $parcel$modules[e]=o,n.call(o.exports,o,o.exports),o.exports}var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t},parcelRequire.register=function(e,n){$parcel$inits[e]=n},$parcel$global.parcelRequire08a5=parcelRequire),parcelRequire.register("fhF9e",(function(module,exports){var $4xklQ=parcelRequire("4xklQ"),$6WmIx=parcelRequire("6WmIx"),$9CUYQ=parcelRequire("9CUYQ"),$apQQe=parcelRequire("apQQe"),$czjZ1=parcelRequire("czjZ1"),cancelExecution=!1;const functionFilter=[{filter:new RegExp("^andarFrente(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^andarTras(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarEsquerda(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarDireita(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^if(\\s+)?\\((\\s+)?.+\\)$"),type:"normal"},{filter:new RegExp("^if(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),type:"blockValidation"},{filter:new RegExp("^contemEsfera(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"normal"},{filter:new RegExp("^{$"),type:"blockValidation"},{filter:new RegExp("^removeEsfera(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"normal"},{filter:new RegExp("^}$"),type:"normal"}],scene=new $4xklQ.Scene,camera=new $4xklQ.PerspectiveCamera(45,2,1,1e3);camera.position.set(0,15,30);const renderer=new $4xklQ.WebGLRenderer({canvas:document.getElementById("sceneView")});window.addEventListener("resize",(function(){(0,$apQQe.resizeCanvasToDisplaySize)(renderer,camera)}),!1);const ambientLight=new $4xklQ.HemisphereLight("white","darkslategrey",.5),mainLight=new $4xklQ.DirectionalLight("white",.7);mainLight.position.set(2,1,1);const controls=new(0,$6WmIx.OrbitControls)(camera,renderer.domElement),gridMapHelper=new(0,$9CUYQ.GridMapHelper),plane=gridMapHelper.createGridPlane(),coneGeometry=new $4xklQ.ConeGeometry(1,2),coneMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(255,0,0)"}),cone=new $4xklQ.Mesh(coneGeometry,coneMaterial);cone.rotateX((0,$apQQe.degreeToRadians)(90));const actor=new $4xklQ.Object3D;actor.add(cone),actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(5)),actor.rotateY((0,$apQQe.degreeToRadians)(90)),console.log(actor.rotation);const sphereGeometry=new $4xklQ.SphereGeometry(1),sphereMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(0,0,255)"}),sphere=new $4xklQ.Mesh(sphereGeometry,sphereMaterial);sphere.position.set(gridMapHelper.getGlobalXPositionFromCoord(9),1,gridMapHelper.getGlobalZPositionFromCoord(5));const boxGeometry=new $4xklQ.BoxGeometry(2,2,2),boxMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(0,255,0)"}),box=new $4xklQ.Mesh(boxGeometry,boxMaterial);function animate(){requestAnimationFrame(animate),controls.update(),renderer.render(scene,camera)}function andarFrente(e){let n=actor.clone();n.translateZ(gridMapHelper.getMultiplier()*e);let o,t=n.position,r=.01;return new Promise((function(e){o=requestAnimationFrame((function i(){let a=gridMapHelper.collisionTests(actor.position);actor.position.x.toFixed(2)==t.x.toFixed(2)&&actor.position.z.toFixed(2)==t.z.toFixed(2)||cancelExecution||a?(a&&(printOnConsole("Não há como prosseguir por esse caminho."),cancelExecution=!0),cancelAnimationFrame(o),n.children[0].geometry.dispose(),n.children[0].material.dispose(),e()):(actor.position.lerp(t,r),r+=.001,o=requestAnimationFrame(i))}))}))}function andarTras(e){let n=actor.clone();n.translateZ(-gridMapHelper.getMultiplier()*e);let o,t=n.position,r=.01;return new Promise((function(e){o=requestAnimationFrame((function i(){let a=gridMapHelper.collisionTests(actor.position);actor.position.x.toFixed(2)==t.x.toFixed(2)&&actor.position.z.toFixed(2)==t.z.toFixed(2)||cancelExecution||a?(a&&(printOnConsole("Não há como prosseguir por esse caminho."),cancelExecution=!0),cancelAnimationFrame(o),n.children[0].geometry.dispose(),n.children[0].material.dispose(),e()):(actor.position.lerp(t,r),r+=.001,o=requestAnimationFrame(i))}))}))}function girarDireita(){let e=actor.clone();e.rotateY((0,$apQQe.degreeToRadians)(-90));let n,o=new $4xklQ.Quaternion;return o.setFromEuler(e.rotation),new Promise((function(t){n=requestAnimationFrame((function r(){actor.quaternion.equals(o)||cancelExecution?(cancelAnimationFrame(n),e.children[0].geometry.dispose(),e.children[0].material.dispose(),t()):(actor.quaternion.rotateTowards(o,(0,$apQQe.degreeToRadians)(1)),n=requestAnimationFrame(r))}))}))}function girarEsquerda(){let e=actor.clone();e.rotateY((0,$apQQe.degreeToRadians)(90));let n,o=new $4xklQ.Quaternion;return o.setFromEuler(e.rotation.clone()),new Promise((function(t){n=requestAnimationFrame((function r(){actor.quaternion.equals(o)||cancelExecution?(cancelAnimationFrame(n),e.children[0].geometry.dispose(),e.children[0].material.dispose(),t()):(actor.quaternion.rotateTowards(o,(0,$apQQe.degreeToRadians)(1)),n=requestAnimationFrame(r))}))}))}function checkCollision(e,n){return gridMapHelper.getXCoordFromGlobalPosition(e.position.x)==gridMapHelper.getXCoordFromGlobalPosition(n.position.x)&&gridMapHelper.getZCoordFromGlobalPosition(e.position.z)==gridMapHelper.getZCoordFromGlobalPosition(n.position.z)}function contemEsfera(){if(cancelExecution)return;let e=checkCollision(actor,sphere);return e||printOnConsole("Esfera não encontrada"),e}function removeEsfera(){cancelExecution||(checkCollision(actor,sphere)?(sphere.visible=!1,printOnConsole("Esfera removida.")):printOnConsole("Objeto não está sobre a esfera."))}function printOnConsole(e){document.getElementById("console-printing").innerHTML+=`${e}<br>`}function printErrorOnConsole(e,n){document.getElementById("console-printing").innerHTML+=`Código Inválido:<br> ${e} linha: ${n}<br>`}function blockValidation(e,n){let o=!1,t=0;for(let r=n+1;r<e.length;r++)if(e[r].includes("}")){if(0==t){o=!0;break}t--}else e[r].includes("{")&&t++;return o}function parseCode(e){let n="async function runCode(){\n",o=e.split("\n"),t=!0;for(let e=0;e<o.length;e++){let r,i=!1;if(""!=o[e].trim()){for(let n=0;n<functionFilter.length;n++)if(i=functionFilter[n].filter.test(o[e].trim()),i){r=functionFilter[n].type;break}if(!i){printErrorOnConsole(o[e],e+1),t=!1;break}if("sequential"===r){n+="await "+o[e].trim()+"\n"}else if("blockValidation"===r){if(!blockValidation(o,e)){printErrorOnConsole(`${o[e]} (Bloco é aberto mas nunca é fechado)`,e+1),t=!1;break}n+=o[e].trim()+"\n"}else{n+=o[e].trim()+"\n"}}}return t?(n+="}\nrunCode()",n):null}function resetLevel(){actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(5)),actor.rotation.set(0,(0,$apQQe.degreeToRadians)(90),0),sphere.visible=!0}function winCondition(){return!(!checkCollision(actor,sphere)||sphere.visible)}box.position.set(gridMapHelper.getGlobalXPositionFromCoord(7),1,gridMapHelper.getGlobalXPositionFromCoord(5)),gridMapHelper.addObstacle(7,7,5,5),scene.add(ambientLight),scene.add(mainLight),scene.add(plane),scene.add(sphere),scene.add(actor),scene.add(box);const execBtn=document.getElementById("execute");execBtn.addEventListener("click",(async function(){let codeParsed=parseCode($czjZ1.editor.state.doc.toString());cancelExecution=!1,null!=codeParsed&&(resetLevel(),document.getElementById("execute").disabled=!0,await eval(codeParsed),winCondition()?($czjZ1.readOnlyState.doc=$czjZ1.editor.state.doc,$czjZ1.editor.setState($czjZ1.readOnlyState),document.getElementById("winMessage").classList.remove("invisible"),document.getElementById("advanceBtn").classList.remove("invisible"),document.getElementById("reset").disabled=!0):document.getElementById("execute").disabled=!1)}));const resetBtn=document.getElementById("reset");resetBtn.addEventListener("click",(function(){cancelExecution=!0,resetLevel()}));const clsConsoleBtn=document.getElementById("clsConsole");clsConsoleBtn.addEventListener("click",(function(){document.getElementById("console-printing").innerHTML=null})),(0,$apQQe.resizeCanvasToDisplaySize)(renderer,camera),animate()})),parcelRequire("fhF9e");