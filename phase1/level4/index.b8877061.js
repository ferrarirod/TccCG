var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire08a5;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var o=$parcel$inits[e];delete $parcel$inits[e];var n={id:e,exports:{}};return $parcel$modules[e]=n,o.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r},parcelRequire.register=function(e,o){$parcel$inits[e]=o},$parcel$global.parcelRequire08a5=parcelRequire),parcelRequire.register("e3iiE",(function(module,exports){var $4xklQ=parcelRequire("4xklQ"),$6WmIx=parcelRequire("6WmIx"),$9CUYQ=parcelRequire("9CUYQ"),$apQQe=parcelRequire("apQQe"),$czjZ1=parcelRequire("czjZ1"),cancelExecution=!1;const functionFilter=[{filter:new RegExp("^andarFrente(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^andarTras(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarEsquerda(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarDireita(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^if(\\s+)?\\((\\s+)?.+\\)$"),type:"normal"},{filter:new RegExp("^if(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),type:"blockValidation"},{filter:new RegExp("^contemEsfera(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"normal"},{filter:new RegExp("^{$"),type:"blockValidation"},{filter:new RegExp("^removeEsfera(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"normal"},{filter:new RegExp("^}$"),type:"normal"}],scene=new $4xklQ.Scene,camera=new $4xklQ.PerspectiveCamera(45,2,1,1e3);camera.position.set(0,15,30);const renderer=new $4xklQ.WebGLRenderer({canvas:document.getElementById("sceneView")});window.addEventListener("resize",(function(){(0,$apQQe.resizeCanvasToDisplaySize)(renderer,camera)}),!1);const ambientLight=new $4xklQ.HemisphereLight("white","darkslategrey",.5),mainLight=new $4xklQ.DirectionalLight("white",.7);mainLight.position.set(2,1,1);const controls=new(0,$6WmIx.OrbitControls)(camera,renderer.domElement),gridMapHelper=new(0,$9CUYQ.GridMapHelper),plane=gridMapHelper.createGridPlane(),coneGeometry=new $4xklQ.ConeGeometry(1,2),coneMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(255,0,0)"}),cone=new $4xklQ.Mesh(coneGeometry,coneMaterial);cone.rotateX((0,$apQQe.degreeToRadians)(90));const actor=new $4xklQ.Object3D;actor.add(cone),actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(2)),actor.rotateY((0,$apQQe.degreeToRadians)(90)),console.log(actor.rotation);const sphereGeometry=new $4xklQ.SphereGeometry(1),sphereMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(0,0,255)"}),sphere1=new $4xklQ.Mesh(sphereGeometry,sphereMaterial),sphere2=new $4xklQ.Mesh(sphereGeometry,sphereMaterial);sphere1.position.set(gridMapHelper.getGlobalXPositionFromCoord(6),1,gridMapHelper.getGlobalZPositionFromCoord(2)),sphere2.position.set(gridMapHelper.getGlobalXPositionFromCoord(7),1,gridMapHelper.getGlobalZPositionFromCoord(8));const boxGeometry=new $4xklQ.BoxGeometry(6,2,2),boxMaterial=new $4xklQ.MeshLambertMaterial({color:"rgb(0,255,0)"}),box=new $4xklQ.Mesh(boxGeometry,boxMaterial);function animate(){requestAnimationFrame(animate),controls.update(),renderer.render(scene,camera)}function andarFrente(e){let o=actor.clone();o.translateZ(gridMapHelper.getMultiplier()*e);let n,r=o.position,t=.01;return new Promise((function(e){n=requestAnimationFrame((function i(){let a=gridMapHelper.collisionTests(actor.position);actor.position.x.toFixed(2)==r.x.toFixed(2)&&actor.position.z.toFixed(2)==r.z.toFixed(2)||cancelExecution||a?(a&&(printOnConsole("Não há como prosseguir por esse caminho."),cancelExecution=!0),cancelAnimationFrame(n),o.children[0].geometry.dispose(),o.children[0].material.dispose(),e()):(actor.position.lerp(r,t),t+=.001,n=requestAnimationFrame(i))}))}))}function andarTras(e){let o=actor.clone();o.translateZ(-gridMapHelper.getMultiplier()*e);let n,r=o.position,t=.01;return new Promise((function(e){n=requestAnimationFrame((function i(){let a=gridMapHelper.collisionTests(actor.position);actor.position.x.toFixed(2)==r.x.toFixed(2)&&actor.position.z.toFixed(2)==r.z.toFixed(2)||cancelExecution||a?(a&&(printOnConsole("Não há como prosseguir por esse caminho."),cancelExecution=!0),cancelAnimationFrame(n),o.children[0].geometry.dispose(),o.children[0].material.dispose(),e()):(actor.position.lerp(r,t),t+=.001,n=requestAnimationFrame(i))}))}))}function girarDireita(){let e=actor.clone();e.rotateY((0,$apQQe.degreeToRadians)(-90));let o,n=new $4xklQ.Quaternion;return n.setFromEuler(e.rotation),new Promise((function(r){o=requestAnimationFrame((function t(){actor.quaternion.equals(n)||cancelExecution?(cancelAnimationFrame(o),e.children[0].geometry.dispose(),e.children[0].material.dispose(),r()):(actor.quaternion.rotateTowards(n,(0,$apQQe.degreeToRadians)(1)),o=requestAnimationFrame(t))}))}))}function girarEsquerda(){let e=actor.clone();e.rotateY((0,$apQQe.degreeToRadians)(90));let o,n=new $4xklQ.Quaternion;return n.setFromEuler(e.rotation.clone()),new Promise((function(r){o=requestAnimationFrame((function t(){actor.quaternion.equals(n)||cancelExecution?(cancelAnimationFrame(o),e.children[0].geometry.dispose(),e.children[0].material.dispose(),r()):(actor.quaternion.rotateTowards(n,(0,$apQQe.degreeToRadians)(1)),o=requestAnimationFrame(t))}))}))}function checkCollision(e,o){return gridMapHelper.getXCoordFromGlobalPosition(e.position.x)==gridMapHelper.getXCoordFromGlobalPosition(o.position.x)&&gridMapHelper.getZCoordFromGlobalPosition(e.position.z)==gridMapHelper.getZCoordFromGlobalPosition(o.position.z)}function contemEsfera(){if(!cancelExecution)return checkCollision(actor,sphere1)||checkCollision(actor,sphere2)?(printOnConsole("Uma esfera foi encontrada."),!0):(printOnConsole("Esfera não encontrada."),!1)}function removeEsfera(){cancelExecution||(checkCollision(actor,sphere1)?(sphere1.visible=!1,printOnConsole("Esfera removida.")):checkCollision(actor,sphere2)?(sphere2.visible=!1,printOnConsole("Esfera removida.")):printOnConsole("Objeto não está sobre a esfera."))}function printOnConsole(e){document.getElementById("console-printing").innerHTML+=`${e}<br>`}function printErrorOnConsole(e,o){document.getElementById("console-printing").innerHTML+=`Código Inválido:<br> ${e} linha: ${o}<br>`}function blockValidation(e,o){let n=!1,r=0;for(let t=o+1;t<e.length;t++)if(e[t].includes("}")){if(0==r){n=!0;break}r--}else e[t].includes("{")&&r++;return n}function parseCode(e){let o="async function runCode(){\n",n=e.split("\n"),r=!0;for(let e=0;e<n.length;e++){let t,i=!1;if(""!=n[e].trim()){for(let o=0;o<functionFilter.length;o++)if(i=functionFilter[o].filter.test(n[e].trim()),i){t=functionFilter[o].type;break}if(!i){printErrorOnConsole(n[e],e+1),r=!1;break}if("sequential"===t){o+="await "+n[e].trim()+"\n"}else if("blockValidation"===t){if(!blockValidation(n,e)){printErrorOnConsole(`${n[e]} (Bloco é aberto mas nunca é fechado)`,e+1),r=!1;break}o+=n[e].trim()+"\n"}else{o+=n[e].trim()+"\n"}}}return r?(o+="}\nrunCode()",o):null}function resetLevel(){actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(2)),actor.rotation.set(0,(0,$apQQe.degreeToRadians)(90),0),sphere1.visible=!0,sphere2.visible=!0}function winCondition(){return!sphere1.visible&&!sphere2.visible}box.position.set(gridMapHelper.getGlobalXPositionFromCoord(6),1,gridMapHelper.getGlobalXPositionFromCoord(7)),gridMapHelper.addObstacle(5,7,7,7),scene.add(ambientLight),scene.add(mainLight),scene.add(plane),scene.add(sphere1),scene.add(sphere2),scene.add(actor),scene.add(box);const execBtn=document.getElementById("execute");execBtn.addEventListener("click",(async function(){let codeParsed=parseCode($czjZ1.editor.state.doc.toString());cancelExecution=!1,null!=codeParsed&&(resetLevel(),document.getElementById("execute").disabled=!0,await eval(codeParsed),winCondition()?($czjZ1.readOnlyState.doc=$czjZ1.editor.state.doc,$czjZ1.editor.setState($czjZ1.readOnlyState),document.getElementById("winMessage").classList.remove("invisible"),document.getElementById("advanceBtn").classList.remove("invisible"),document.getElementById("reset").disabled=!0):document.getElementById("execute").disabled=!1)}));const resetBtn=document.getElementById("reset");resetBtn.addEventListener("click",(function(){cancelExecution=!0,resetLevel()}));const clsConsoleBtn=document.getElementById("clsConsole");clsConsoleBtn.addEventListener("click",(function(){document.getElementById("console-printing").innerHTML=null})),(0,$apQQe.resizeCanvasToDisplaySize)(renderer,camera),animate()})),parcelRequire("e3iiE");